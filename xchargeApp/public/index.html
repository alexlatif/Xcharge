<!doctype <!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Xcharge</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/js/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.0.0-beta.33/src/index.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
    <h3 id="myGas" style="
    margin-left: 35px;
    font-size: 30px;
    font-weight: bolder;">Choose your car wallet</h3>
    <img class="porsche" src="https://upload.wikimedia.org/wikipedia/de/2/2d/Porsche_Wappen.svg" style="
    height: auto;
    width: 130px;
    margin-left: 123px;
    margin-top: 30px;">
    <img src="./back.png" style="
    height: 40px;
    position: absolute;
    margin-left: -187px;
    margin-top: 85px;"/>
    <img src="./next.png" style="
    height: 40px;
    position: absolute;
    margin-left: 14px;
    margin-top: 84px;"/>
    <h4 id="balance" style="
    position: absolute;
    margin-top: 40px;
    margin-left: 40px;">Your balance: ... eth</h4>
    <h5 id="con1" style="
    display: none;">connection established</h5>
    <h5 id="con2" style="
    display: none;">we will notify when charging starts</h5>
    <a class="waves-effect waves-light btn" id="aBut" style="
    background-color: white; 
    color: black;
    height: 100px;
    width: 100px;
    font-size: 50px;
    padding-top: 30px;
    position: absolute;
    margin-top: 320px;
    left: 60px;"
    onclick="pressA()"><img src="https://upload.wikimedia.org/wikipedia/en/b/ba/Flag_of_Germany.svg"
    style="
    height: 40px;"/></a>
    <h5 id="rate" style="
    position: absolute;
    margin-top: 228px;
    margin-left: 48px;">0.5 eth/kWhr</h5>
    <a class="waves-effect waves-light btn" id="bBut" style="
    background-color: white; 
    color: black;
    height: 100px;
    width: 100px;
    font-size: 50px;
    padding-top: 30px;
    margin-top: 320px;
    position: absolute;
    left: 213px;"
    onclick="pressB()"><img src="https://upload.wikimedia.org/wikipedia/en/c/c3/Flag_of_France.svg"
    style="
    height: 40px;"/></a>
    <h5 id="rate1" style="
    position: absolute;
    margin-left: 212px;
    margin-top: 228px;">0.8 eth/kWhr</h5>
    <h4 style="position: absolute;"></h4>
    <a class="waves-effect waves-light btn" id="processing" style="display: none;" onclick="pressStop()">processing payment...</a>
    <a class="waves-effect waves-light btn" id="stopBut" style="
    display: none;"
    onclick="pressStop()">stop charge</a>

    <script>

        var url = "http://localhost:3000/"

        // function handlers
        function pressA() {
            document.getElementById('aBut').style.cssText = 'display: none'
            document.getElementById('bBut').style.cssText = 'display: none'
            document.getElementById('rate').style.cssText = 'display: none'
            document.getElementById('rate1').style.cssText = 'display: none'
            document.getElementById('con1').style.cssText = 'position: absolute; margin-top: 82px; margin-left: 67px; color: green;'
            // document.getElementById('con2').style.cssText = 'position: absolute; margin-top: 94px; margin-left: 73px;'
            document.getElementById('processing').style.cssText = 'background-color: orange; color: white; font-size: 20px;width: 300px;height: 100px; padding-top: 34px; margin-top: 328px; margin-left: 10px;position: absolute; left: 30px;'

            axios.get(url + 'ropsten')
                .then((response) => {
                    console.log('has started A')
                    document.getElementById('con1').style.cssText = 'display: none'
                    document.getElementById('stopBut').style.cssText = 'background-color: red; color: white; font-size: 30px;width: 300px;height: 100px; padding-top: 34px; margin-top: 328px; margin-left: 10px;position: absolute; left: 30px;'
                })
                .catch(function (error) {
                    console.log(error);
                });
        }

        // function handlers
        function pressB() {
            document.getElementById('aBut').style.cssText = 'display: none'
            document.getElementById('bBut').style.cssText = 'display: none'
            document.getElementById('rate').style.cssText = 'display: none'
            document.getElementById('rate1').style.cssText = 'display: none'
            document.getElementById('con1').style.cssText = 'position: absolute; margin-top: 82px; margin-left: 67px; color: green;'
            document.getElementById('processing').style.cssText = 'background-color: orange; color: white; font-size: 20px;width: 300px;height: 100px; padding-top: 34px; margin-top: 315px; margin-left: 10px;position: absolute; left: 30px;'

            axios.get(url + 'rinkeby')
                .then((response) => {
                        console.log('has started B')
                        document.getElementById('con1').style.cssText = 'display: none'
                        document.getElementById('stopBut').style.cssText = 'background-color: red; color: white; font-size: 30px;width: 300px;height: 100px; padding-top: 34px; margin-top: 315px; margin-left: 10px;position: absolute; left: 30px;'
                })
                .catch(function (error) {
                    console.log(error);
                });
        }

        //function handlers
        function pressStop() {
            document.getElementById('stopBut').style.cssText = 'display: none'
            document.getElementById('processing').style.cssText = 'display: none'
            document.getElementById('con1').style.cssText = 'display: none'
            document.getElementById('con2').style.cssText = 'display: none'
            document.getElementById('aBut').style.cssText = 'background-color: white; color: black; height: 100px; width: 100px; font-size: 50px; padding-top: 30px; margin-top: 320px; position: absolute; left: 60px;'
            document.getElementById('bBut').style.cssText = 'background-color: white; color: black; height: 100px; width: 100px; font-size: 50px; padding-top: 30px; margin-top: 320px; position: absolute; left: 213px;'
            document.getElementById('rate').style.cssText = 'position: absolute; margin-left: 60px; margin-top: 228px;'
            document.getElementById('rate1').style.cssText = 'position: absolute; margin-left: 212px; margin-top: 228px;'
            axios.get(url + 'stop')
                .then((response) => {
                    axios.get(url + 'getstuff')
                        .then((response) => {
                            console.log('balance + rates & energy type', JSON.parse(response.data))
                            var balance = JSON.parse(response.data).balance / 1000000000000000
                            document.getElementById('balance').innerText = 'Your balance: ' + balance + ' eth';
                        })
                        .catch(function (error) {
                            console.log(error);
                        });
                })
                .catch(function (error) {
                    console.log(error);
                });
        }
        
       (function getStuff() {
            axios.get(url + 'getstuff')
               .then((response) => {
                   console.log('balance + rates & energy type', JSON.parse(response.data))
                   var balance = JSON.parse(response.data).balance / 1000000000000000
                   document.getElementById('balance').innerText = 'Your balance: ' + balance + ' eth';
               })
               .catch(function (error) {
                   console.log(error);
               });
        })()

    </script>
    <script type="text/javascript" src="js/eventHandlers.js" />
</body>
</html>